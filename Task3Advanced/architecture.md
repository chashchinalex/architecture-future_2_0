# Описание целевой архитектуры "Будущее 2.0" (Горизонт 3 года)

## 1. Общая концепция
Целевая архитектура спроектирована как **Event-Driven Architecture (EDA)** в облачном окружении с переходом к подходу **Data Mesh** в аналитике. 

Основная цель трансформации — устранить узкие места монолитного DWH (SQL Server 2008) и legacy-интерфейсов (PowerBuilder), обеспечив независимое масштабирование бизнес-направлений (Медицина, Финтех, ИИ).

### Ключевые архитектурные принципы:
* **Decentralization (Децентрализация):** Каждое бизнес-направление выделяется в отдельный домен со своим tech stack и операционными базами данных.
* **Async First (Асинхронность):** Синхронная интеграция заменяется на обмен событиями через шину (Kafka), что снижает связность (coupling).
* **Separation of Concerns (Разделение ответственности):** Операционные данные (OLTP) отделены от аналитических (OLAP). Медицинские карты недоступны для прямой аналитики в целях безопасности.

---

## 2. Структура доменов (Containers)

###  Домен: Медицина
Заменяет legacy-систему на PowerBuilder.
* **Frontend:** Веб-портал (React/Angular) для врачей и операторов. Обеспечивает кроссплатформенность.
* **Backend:** Микросервисы на Java/Kotlin (Spring Boot).
* **Storage:** PostgreSQL для оперативных данных. Прямой доступ к БД извне запрещен.

###  Домен: Финтех
Обеспечивает банковские операции, купленный актив.
* **Core:** Сервисы на Go/Java для высокой производительности и надежности.
* **Storage:** PostgreSQL или CockroachDB (для распределенных транзакций). Требует строгой согласованности (Strong Consistency).
* **Интеграция:** Подписывается на события `DiagnosisCreated` для выставления счетов, публикует `PaymentSuccess`.

### Домен: ИИ-сервисы
Новое направление для диагностики.
* **Engine:** Python (PyTorch/TensorFlow).
* **Storage:** S3 для хранения "сырых" снимков (DICOM) и Vector DB (Milvus) для поиска по эмбеддингам.
* **Flow:** Работает реактивно — анализ запускается по событию `ImageUploaded`.

---

## 3. Платформа данных и Витрина (Data Mesh)

Вместо монолитного DWH внедряется современная платформа данных для реализации требования "Витрина самообслуживания".

1.  **Ingestion (Загрузка):** Используется паттерн **CDC (Change Data Capture)** через Kafka Connect/Debezium. Любые изменения в операционных БД доменов мгновенно попадают в шину данных.
2.  **Storage (Хранение):** Data Lakehouse (S3 + Delta Lake/Iceberg). Позволяет хранить огромные объемы данных дешевле, чем в SQL Server, и поддерживает ACID-транзакции на уровне файлов.
3.  **Governance (Управление):**
    * **Schema Registry:** Гарантирует, что форматы данных совместимы.
    * **Data Catalog (DataHub):** Позволяет аналитикам искать данные и понимать их происхождение (Data Lineage).
4.  **Analytics (Витрина):** BI-инструменты (Superset/PowerBI) подключаются к Lakehouse через SQL-движок (Trino/Presto). Аналитики строят отчеты сами, не нагружая разработчиков.

---

## 4. Инфраструктура и Безопасность
* **Облако:** Все компоненты разворачиваются в Managed Kubernetes (K8s) облачного провайдера.
* **API Gateway:** Единая точка входа, обеспечивающая Authentication/Authorization и Rate Limiting.
* **Security:** Медицинские данные (PHI) хранятся в изолированном контуре. В аналитическое хранилище они попадают только в обезличенном виде (Data Masking).

